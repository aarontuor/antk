

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>loader &mdash; antk 1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
    <link rel="top" title="antk 1.0 documentation" href="index.html"/>
        <link rel="up" title="API: ANT modules" href="api.html"/>
        <link rel="next" title="Loader Tutorial" href="loader_tutorial.html"/>
        <link rel="prev" title="API: ANT modules" href="api.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> antk
          

          
            
            <img src="_static/antlogo_cut_shrunk2.png" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="api.html">API: ANT modules</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="">loader</a><ul>
<li class="toctree-l3"><a class="reference internal" href="loader_tutorial.html">Loader Tutorial</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-loader">API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#proposed-extensions">Proposed Extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loading-saving-and-testing">Loading, Saving, and Testing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#classes">Classes</a></li>
<li class="toctree-l4"><a class="reference internal" href="#data-transforms">Data Transforms</a></li>
<li class="toctree-l4"><a class="reference internal" href="#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="config.html">config</a></li>
<li class="toctree-l2"><a class="reference internal" href="node_ops.html">node_ops</a></li>
<li class="toctree-l2"><a class="reference internal" href="generic_model.html">generic_model</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html">Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html">Command Line Scripts</a></li>
<li class="toctree-l1"><a class="reference internal" href="command_line.html#movie-lens-processing">Movie Lens Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">antk</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
          <li><a href="api.html">API: ANT modules</a> &raquo;</li>
      
    <li>loader</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/loader.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="loader">
<h1>loader<a class="headerlink" href="#loader" title="Permalink to this headline">¶</a></h1>
<p>Implements a general purpose data loader for python non-sequential machine learning tasks. Several common data transformations are provided in this module, e.g., tfidf, whitening, etc.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="loader_tutorial.html">Loader Tutorial</a><ul>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#supported-data-types">Supported Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#hotindex-objects">HotIndex objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#supported-file-formats">Supported File Formats</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#import-and-export-data">Import and export data</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#the-dataset-object">The <code class="docutils literal"><span class="pre">DataSet</span></code> object</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#read-data-sets-the-loading-function">read_data_sets: The loading function</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#loading-saving-and-testing">Loading, Saving, and Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#classes">Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#data-transforms">Data Transforms</a></li>
<li class="toctree-l2"><a class="reference internal" href="loader_tutorial.html#exceptions">Exceptions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-loader">
<span id="api"></span><h2>API<a class="headerlink" href="#module-loader" title="Permalink to this headline">¶</a></h2>
<div class="section" id="proposed-extensions">
<h3>Proposed Extensions<a class="headerlink" href="#proposed-extensions" title="Permalink to this headline">¶</a></h3>
<p>DataSet.split(scheme={devtraintest, crossvalidate, traintest} returns DataSets</p>
<p>DataSets.join() returns DataSet (combines train or cross validation)</p>
<p>DataSet + DataSet returns DataSet</p>
<p>DataSets + DataSets returns DataSets</p>
<p>DataSets constructor from list of DataSet objects</p>
<p>DataSet for Online data</p>
<p>DataSet for Sequence data</p>
<p>Binary data formats for Streaming data</p>
</div>
<div class="section" id="loading-saving-and-testing">
<h3>Loading, Saving, and Testing<a class="headerlink" href="#loading-saving-and-testing" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#loader.save" title="loader.save"><code class="xref any py py-func docutils literal"><span class="pre">save</span></code></a></p>
<p><a class="reference internal" href="#loader.load" title="loader.load"><code class="xref any py py-func docutils literal"><span class="pre">load</span></code></a></p>
<p><a class="reference internal" href="#loader.is_one_hot" title="loader.is_one_hot"><code class="xref any py py-func docutils literal"><span class="pre">is_one_hot</span></code></a></p>
<p><a class="reference internal" href="#loader.read_data_sets" title="loader.read_data_sets"><code class="xref any py py-func docutils literal"><span class="pre">read_data_sets</span></code></a></p>
<p><a class="reference internal" href="#loader.untar" title="loader.untar"><code class="xref any py py-func docutils literal"><span class="pre">untar</span></code></a></p>
<p><a class="reference internal" href="#loader.maybe_download" title="loader.maybe_download"><code class="xref any py py-func docutils literal"><span class="pre">maybe_download</span></code></a></p>
</div>
<div class="section" id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a></p>
<p><a class="reference internal" href="#loader.DataSets" title="loader.DataSets"><code class="xref any py py-class docutils literal"><span class="pre">DataSets</span></code></a></p>
<p><a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a></p>
<p><a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a></p>
</div>
<div class="section" id="data-transforms">
<h3>Data Transforms<a class="headerlink" href="#data-transforms" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#loader.center" title="loader.center"><code class="xref any py py-func docutils literal"><span class="pre">center</span></code></a></p>
<p><a class="reference internal" href="#loader.l1normalize" title="loader.l1normalize"><code class="xref any py py-func docutils literal"><span class="pre">l1normalize</span></code></a></p>
<p><a class="reference internal" href="#loader.l2normalize" title="loader.l2normalize"><code class="xref any py py-func docutils literal"><span class="pre">l2normalize</span></code></a></p>
<p><a class="reference internal" href="#loader.tfidf" title="loader.tfidf"><code class="xref any py py-func docutils literal"><span class="pre">tfidf</span></code></a></p>
<p><a class="reference internal" href="#loader.toOnehot" title="loader.toOnehot"><code class="xref any py py-func docutils literal"><span class="pre">toOnehot</span></code></a></p>
<p><a class="reference internal" href="#loader.toIndex" title="loader.toIndex"><code class="xref any py py-func docutils literal"><span class="pre">toIndex</span></code></a></p>
<p><a class="reference internal" href="#loader.unit_variance" title="loader.unit_variance"><code class="xref any py py-func docutils literal"><span class="pre">unit_variance</span></code></a></p>
</div>
<div class="section" id="exceptions">
<h3>Exceptions<a class="headerlink" href="#exceptions" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#loader.BadDirectoryStructureError" title="loader.BadDirectoryStructureError"><code class="xref any py py-exc docutils literal"><span class="pre">BadDirectoryStructureError</span></code></a></p>
<p><a class="reference internal" href="#loader.MatFormatError" title="loader.MatFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">MatFormatError</span></code></a></p>
<p><a class="reference internal" href="#loader.SparseFormatError" title="loader.SparseFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">SparseFormatError</span></code></a></p>
<p><a class="reference internal" href="#loader.UnsupportedFormatError" title="loader.UnsupportedFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">UnsupportedFormatError</span></code></a></p>
<dl class="exception">
<dt id="loader.BadDirectoryStructureError">
<em class="property">exception </em><code class="descclassname">loader.</code><code class="descname">BadDirectoryStructureError</code><a class="reference internal" href="_modules/loader.html#BadDirectoryStructureError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.BadDirectoryStructureError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a data directory specified, does not contain
a subfolder specified in the <em>folders</em> argument to 
<a class="reference internal" href="#loader.read_data_sets" title="loader.read_data_sets"><code class="xref any py py-func docutils literal"><span class="pre">read_data_sets</span></code></a>.</p>
</dd></dl>

<dl class="class">
<dt id="loader.DataSet">
<em class="property">class </em><code class="descclassname">loader.</code><code class="descname">DataSet</code><span class="sig-paren">(</span><em>features</em>, <em>labels=None</em>, <em>mix=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSet" title="Permalink to this definition">¶</a></dt>
<dd><p>Data structure for mini-batch gradient descent training involving non-sequential data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>features</strong> &#8211; (dict) A dictionary of string label names to data matrices.
Matrices may be of types <a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a>, scipy sparse csr_matrix, or numpy array.</li>
<li><strong>labels</strong> &#8211; (dict) A dictionary of string label names to data matrices.
Matrices may be of types <a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a>, scipy sparse csr_matrix, or numpy array.</li>
<li><strong>mix</strong> &#8211; (boolean) Whether or not to shuffle per epoch.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Examples:</th><td class="field-body"><div class="first highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core.loader</span> <span class="kn">import</span> <span class="n">DataSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DataSet</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">)},</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;ones&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">))})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> 
<span class="go">antk.core.DataSet object with fields:</span>
<span class="go">&#39;_labels&#39;: {&#39;ones&#39;: array([[ 1.,  1.],</span>
<span class="go">                           [ 1.,  1.],</span>
<span class="go">                           [ 1.,  1.],</span>
<span class="go">                           [ 1.,  1.],</span>
<span class="go">                           [ 1.,  1.]])}</span>
<span class="go">&#39;mix_after_epoch&#39;: False</span>
<span class="go">&#39;_num_examples&#39;: 5</span>
<span class="go">&#39;_index_in_epoch&#39;: 0</span>
<span class="go">&#39;_last_batch_size&#39;: 5</span>
<span class="go">&#39;_features&#39;: {&#39;id&#39;: array([[ 1.,  0.,  0.,  0.,  0.],</span>
<span class="go">                           [ 0.,  1.,  0.,  0.,  0.],</span>
<span class="go">                           [ 0.,  0.,  1.,  0.,  0.],</span>
<span class="go">                           [ 0.,  0.,  0.,  1.,  0.],</span>
<span class="go">                           [ 0.,  0.,  0.,  0.,  1.]])}</span>
</pre></div>
</div>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<span class="go">features:</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">     ones: (5, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">next_batch</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> 
<span class="go">antk.core.DataSet object with fields:</span>
<span class="go">    &#39;_labels&#39;: {&#39;ones&#39;: array([[ 1.,  1.],</span>
<span class="go">                               [ 1.,  1.],</span>
<span class="go">                               [ 1.,  1.]])}</span>
<span class="go">    &#39;mix_after_epoch&#39;: False</span>
<span class="go">    &#39;_num_examples&#39;: 3</span>
<span class="go">    &#39;_index_in_epoch&#39;: 0</span>
<span class="go">    &#39;_last_batch_size&#39;: 3</span>
<span class="go">    &#39;_features&#39;: {&#39;id&#39;: array([[ 1.,  0.,  0.,  0.,  0.],</span>
<span class="go">                               [ 0.,  1.,  0.,  0.,  0.],</span>
<span class="go">                               [ 0.,  0.,  1.,  0.,  0.]])}</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="loader.DataSet.features">
<code class="descname">features</code><a class="headerlink" href="#loader.DataSet.features" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(dict) A dictionary with string keys and feature matrix values.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="loader.DataSet.index_in_epoch">
<code class="descname">index_in_epoch</code><a class="headerlink" href="#loader.DataSet.index_in_epoch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(int) The number of data points that have been trained on in a particular epoch.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="loader.DataSet.labels">
<code class="descname">labels</code><a class="headerlink" href="#loader.DataSet.labels" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(dict) A dictionary with string keys and label matrix values.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="loader.DataSet.next_batch">
<code class="descname">next_batch</code><span class="sig-paren">(</span><em>batch_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSet.next_batch"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSet.next_batch" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
<dl class="docutils">
<dt>Return a sub DataSet of next batch-size examples.</dt>
<dd><dl class="first last docutils">
<dt>If no shuffling (mix=False):</dt>
<dd>If <cite>batch_size</cite> is greater than the number of examples left in
the epoch then a batch size DataSet wrapping past beginning
(rows [index_in_epcoch:num_examples, 0:<a class="reference internal" href="#loader.DataSet.num_examples" title="loader.DataSet.num_examples"><code class="xref any py py-attr docutils literal"><span class="pre">num_examples</span></code></a>-<a class="reference internal" href="#loader.DataSet.index_in_epoch" title="loader.DataSet.index_in_epoch"><code class="xref any py py-attr docutils literal"><span class="pre">index_in_epoch</span></code></a>]
will be returned.</dd>
<dt>If shuffling enabled (mix=True):</dt>
<dd>If <cite>batch_size</cite> is greater than the number of examples left in the epoch,
points will be shuffled and <cite>batch_size</cite> DataSet is returned starting from index 0.</dd>
</dl>
</dd>
</dl>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>batch_size</strong> &#8211; (int) The number of rows in the matrices of the sub DataSet.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="loader.DataSet.num_examples">
<code class="descname">num_examples</code><a class="headerlink" href="#loader.DataSet.num_examples" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(int) Number of rows (data points) of the matrices in this <a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="loader.DataSet.reset_index_to_zero">
<code class="descname">reset_index_to_zero</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSet.reset_index_to_zero"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSet.reset_index_to_zero" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body">Sets <a class="reference internal" href="#loader.DataSet.index_in_epoch" title="loader.DataSet.index_in_epoch"><code class="xref any py py-attr docutils literal"><span class="pre">index_in_epoch</span></code></a> to 0.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="loader.DataSet.show">
<code class="descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSet.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSet.show" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body">Prints the data specs (dimensions, keys, type) in the <a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a> object</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="loader.DataSet.showmore">
<code class="descname">showmore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSet.showmore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSet.showmore" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body">Prints the data specs (dimensions, keys, type) in the <a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a> object,</td>
</tr>
</tbody>
</table>
<p>along with a sample of up to the first twenty rows for matrices in DataSet.</p>
</dd></dl>

<dl class="method">
<dt id="loader.DataSet.shuffle">
<code class="descname">shuffle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSet.shuffle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSet.shuffle" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body">The same random permutation is applied to the
rows of all the matrices in <a class="reference internal" href="#loader.DataSet.features" title="loader.DataSet.features"><code class="xref any py py-attr docutils literal"><span class="pre">features</span></code></a> and <a class="reference internal" href="#loader.DataSet.labels" title="loader.DataSet.labels"><code class="xref any py py-attr docutils literal"><span class="pre">labels</span></code></a> .</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="loader.DataSets">
<em class="property">class </em><code class="descclassname">loader.</code><code class="descname">DataSets</code><span class="sig-paren">(</span><em>datasets_map={}</em>, <em>mix=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSets" title="Permalink to this definition">¶</a></dt>
<dd><p>A record of <a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a> objects.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>datasets_map</strong> &#8211; (dict) A dictionary with string keys and <cite>DataSet</cite> objects as values.</li>
<li><strong>mix</strong> &#8211; (boolean) Whether or not to enable shuffling for mini-batching.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Attributes:</th><td class="field-body"><p class="first last">(<a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a>) There is an attribute for each key value pair in</p>
</td>
</tr>
</tbody>
</table>
<p><strong>datasets_map</strong> argument.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core.loader</span> <span class="kn">import</span> <span class="n">DataSets</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core.loader</span> <span class="kn">import</span> <span class="n">DataSet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="n">DataSets</span><span class="p">({</span><span class="s1">&#39;train&#39;</span><span class="p">:</span> <span class="n">DataSet</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">)},</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">))}),</span>
<span class="gp">... </span>              <span class="s1">&#39;dev&#39;</span><span class="p">:</span> <span class="n">DataSet</span><span class="p">({</span><span class="s1">&#39;id&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">2</span><span class="p">)},</span> <span class="n">labels</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;one&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">6</span><span class="p">))})})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<span class="go">dev:</span>
<span class="go">features:</span>
<span class="go">     id: (2, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">     one: (2, 6) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">train:</span>
<span class="go">features:</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">     one: (5, 6) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="o">.</span><span class="n">showmore</span><span class="p">()</span> 
<span class="go">dev:</span>
<span class="go">features:</span>
<span class="go">     id:</span>
<span class="go">First 2 rows:</span>
<span class="go">[[ 5.  0.]</span>
<span class="go"> [ 0.  5.]]</span>

<span class="go">labels:</span>
<span class="go">     one:</span>
<span class="go">First 2 rows:</span>
<span class="go">[[ 5.  5.  5.  5.  5.  5.]</span>
<span class="go"> [ 5.  5.  5.  5.  5.  5.]]</span>

<span class="go">train:</span>
<span class="go">features:</span>
<span class="go">     id:</span>
<span class="go">First 5 rows:</span>
<span class="go">[[ 1.  0.  0.  0.  0.]</span>
<span class="go"> [ 0.  1.  0.  0.  0.]</span>
<span class="go"> [ 0.  0.  1.  0.  0.]</span>
<span class="go"> [ 0.  0.  0.  1.  0.]</span>
<span class="go"> [ 0.  0.  0.  0.  1.]]</span>

<span class="go">labels:</span>
<span class="go">     one:</span>
<span class="go">First 5 rows:</span>
<span class="go">[[ 1.  1.  1.  1.  1.  1.]</span>
<span class="go"> [ 1.  1.  1.  1.  1.  1.]</span>
<span class="go"> [ 1.  1.  1.  1.  1.  1.]</span>
<span class="go"> [ 1.  1.  1.  1.  1.  1.]</span>
<span class="go"> [ 1.  1.  1.  1.  1.  1.]]</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="loader.DataSets.show">
<code class="descname">show</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSets.show"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSets.show" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body">Pretty print data attributes.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="loader.DataSets.showmore">
<code class="descname">showmore</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#DataSets.showmore"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.DataSets.showmore" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body">Pretty print data attributes, and data.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="loader.HotIndex">
<em class="property">class </em><code class="descclassname">loader.</code><code class="descname">HotIndex</code><span class="sig-paren">(</span><em>matrix</em>, <em>dimension=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#HotIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.HotIndex" title="Permalink to this definition">¶</a></dt>
<dd><p>Same data structure as <a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a>. This is the legacy name.</p>
</dd></dl>

<dl class="class">
<dt id="loader.IndexVector">
<em class="property">class </em><code class="descclassname">loader.</code><code class="descname">IndexVector</code><span class="sig-paren">(</span><em>matrix</em>, <em>dimension=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#IndexVector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.IndexVector" title="Permalink to this definition">¶</a></dt>
<dd><p>Index vector representation of one hot matrix.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>matrix</strong> &#8211; (scipy.sparse.csr_matrix or numpy array)
A one hot matrix or vector of <em>on</em> indices of a one hot matrix.
If <strong>matrix</strong> is a vector of indices and no dimension argument is supplied
then <strong>dimension</strong> is set to the maximum index value + 1.</li>
<li><strong>dimension</strong> &#8211; (int) The number of columns in the one hot matrix to be represented.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">IndexVector objects implement the python sequence protocol, so slicing,
indexing and iteration behave as you might expect.
Slices of an IndexVector return another IndexVector.
Indexing returns an integer. Iteration will loop over all the elements
in the <a class="reference internal" href="#loader.IndexVector.vec" title="loader.IndexVector.vec"><code class="xref any py py-attr docutils literal"><span class="pre">vec</span></code></a> attribute.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xhot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">IndexVector</span><span class="p">(</span><span class="n">xhot</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="o">.</span><span class="n">vec</span>
<span class="go">array([0, 0, 1, 2])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="o">.</span><span class="n">dim</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="o">.</span><span class="n">hot</span><span class="p">()</span> 
<span class="go">&lt;4x3 sparse matrix of type &#39;&lt;type &#39;numpy.float64&#39;&gt;&#39;</span>
<span class="go">    with 4 stored elements in Compressed Sparse Row format&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="o">.</span><span class="n">hot</span><span class="p">()</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span> 
<span class="go">array([[ 1.,  0.,  0.],</span>
<span class="go">       [ 1.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(4, 3)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span>
<span class="go">&lt;class &#39;antk.core.loader.IndexVector&#39;&gt;(shape=(4, 3))</span>
<span class="go">vec=[0, 0, 1, 2]</span>
<span class="go">dim=3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xindex</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">&lt;class &#39;antk.core.loader.IndexVector&#39;&gt;(shape=(2, 3))</span>
<span class="go">vec=[0, 1]</span>
<span class="go">dim=3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">[</span><span class="n">index</span><span class="o">+</span><span class="mi">2</span> <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">xindex</span><span class="p">]</span>
<span class="go">[2, 2, 3, 4]</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="loader.IndexVector.dim">
<code class="descname">dim</code><a class="headerlink" href="#loader.IndexVector.dim" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(int) The feature dimension (number of columns) of the one hot matrix.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="loader.IndexVector.hot">
<code class="descname">hot</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#IndexVector.hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.IndexVector.hot" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Method:</th><td class="field-body"></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A one hot scipy sparse csr_matrix</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="loader.IndexVector.shape">
<code class="descname">shape</code><a class="headerlink" href="#loader.IndexVector.shape" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(tuple) The shape of the one hot matrix encoded.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="loader.IndexVector.vec">
<code class="descname">vec</code><a class="headerlink" href="#loader.IndexVector.vec" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Attribute:</th><td class="field-body">(numpy 1d array) The vector of hot indices.</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="exception">
<dt id="loader.MatFormatError">
<em class="property">exception </em><code class="descclassname">loader.</code><code class="descname">MatFormatError</code><a class="reference internal" href="_modules/loader.html#MatFormatError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.MatFormatError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised if the .mat file being read does not contain a
variable named <em>data</em>.</p>
</dd></dl>

<dl class="exception">
<dt id="loader.SparseFormatError">
<em class="property">exception </em><code class="descclassname">loader.</code><code class="descname">SparseFormatError</code><a class="reference internal" href="_modules/loader.html#SparseFormatError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.SparseFormatError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when reading a plain text file with .sparsetxt
extension and there are not three entries per line.</p>
</dd></dl>

<dl class="exception">
<dt id="loader.UnsupportedFormatError">
<em class="property">exception </em><code class="descclassname">loader.</code><code class="descname">UnsupportedFormatError</code><a class="reference internal" href="_modules/loader.html#UnsupportedFormatError"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.UnsupportedFormatError" title="Permalink to this definition">¶</a></dt>
<dd><p>Raised when a file is requested to be loaded or saved without one
of the supported file extensions.</p>
</dd></dl>

<dl class="function">
<dt id="loader.center">
<code class="descclassname">loader.</code><code class="descname">center</code><span class="sig-paren">(</span><em>X</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#center"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.center" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>X</strong> &#8211; (numpy array or scipy.sparse.csr_matrix) A matrix to center about the
mean(over columns axis=0, over rows axis=1, over all entries axis=None)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A matrix with entries centered along the specified axis.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.export_data">
<code class="descclassname">loader.</code><code class="descname">export_data</code><span class="sig-paren">(</span><em>filename</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#export_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.export_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Decides how to save data by file extension.
Raises <a class="reference internal" href="#loader.UnsupportedFormatError" title="loader.UnsupportedFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">UnsupportedFormatError</span></code></a> if extension is not one of the supported
extensions (mat, sparse, binary, dense, index).
Data contained in .mat files should be saved in a matrix named <em>data</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> &#8211; A file of an accepted format representing a matrix.</li>
<li><strong>data</strong> &#8211; A numpy array, scipy sparse matrix, or <a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a> object.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.import_data">
<code class="descclassname">loader.</code><code class="descname">import_data</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#import_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.import_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Decides how to load data into python matrices by file extension.
Raises <a class="reference internal" href="#loader.UnsupportedFormatError" title="loader.UnsupportedFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">UnsupportedFormatError</span></code></a> if extension is not one of the supported
extensions (mat, sparse, binary, dense, sparsetxt, densetxt, index).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; (str) A file of an accepted format representing a matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A numpy matrix, scipy sparse csr_matrix, or any:<cite>IndexVector</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.is_one_hot">
<code class="descclassname">loader.</code><code class="descname">is_one_hot</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#is_one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.is_one_hot" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A</strong> &#8211; A 2-d numpy array or scipy sparse matrix</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">True if matrix is a sparse matrix of one hot vectors, False otherwise</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">is_one_hot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">*=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">is_one_hot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">is_one_hot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">is_one_hot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.l1normalize">
<code class="descclassname">loader.</code><code class="descname">l1normalize</code><span class="sig-paren">(</span><em>X</em>, <em>axis=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#l1normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.l1normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>axis=1 normalizes each row of X by norm of said row. <span class="math">\(l1normalize(X)_{ij} = \frac{X_{ij}}{\sum_k |X_{ik}|}\)</span></p>
<p>axis=0 normalizes each column of X by norm of said column. <span class="math">\(l1normalize(X)_{ij} = \frac{X_{ij}}{\sum_k
|X_{kj}|}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> &#8211; A scipy sparse csr_matrix or numpy array.</li>
<li><strong>axis</strong> &#8211; The dimension to normalize over.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A normalized matrix.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raise:</th><td class="field-body"><p class="first last">ValueError</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.l2normalize">
<code class="descclassname">loader.</code><code class="descname">l2normalize</code><span class="sig-paren">(</span><em>X</em>, <em>axis=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#l2normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.l2normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>axis=1 normalizes each row of X by norm of said row. <span class="math">\(l2normalize(X)_{ij} = \frac{X_{ij}}{\sqrt{\sum_k X_{
ik}^2}}\)</span></p>
<p>axis=0 normalizes each column of X by norm of said column. <span class="math">\(l2normalize(X)_{ij} = \frac{X_{ij}}{\sqrt{\sum_k
X_{kj}^2}}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> &#8211; A scipy sparse csr_matrix or numpy array.</li>
<li><strong>axis</strong> &#8211; The dimension to normalize over.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A normalized matrix.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raise:</th><td class="field-body"><p class="first last">ValueError</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.load">
<code class="descclassname">loader.</code><code class="descname">load</code><span class="sig-paren">(</span><em>filename</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls <a class="reference internal" href="#loader.import_data" title="loader.import_data"><code class="xref any py py-func docutils literal"><span class="pre">import_data</span></code></a>.
Decides how to load data into python matrices by file extension.
Raises <a class="reference internal" href="#loader.UnsupportedFormatError" title="loader.UnsupportedFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">UnsupportedFormatError</span></code></a> if extension is not one of the supported
extensions (mat, sparse, binary, dense, sparsetxt, densetxt, index).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; (str) A file of an accepted format representing a matrix.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">A numpy matrix, scipy sparse csr_matrix, or any:<cite>IndexVector</cite>.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.makedirs">
<code class="descclassname">loader.</code><code class="descname">makedirs</code><span class="sig-paren">(</span><em>datadirectory</em>, <em>sub_directory_list=('train'</em>, <em>'dev'</em>, <em>'test')</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#makedirs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.makedirs" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>datadirectory</strong> &#8211; Name of the directory you want to create containing the subdirectory folders.
If the directory already exists it will be populated with the subdirectory folders.</li>
<li><strong>sub_directory_list</strong> &#8211; The list of subdirectories you want to create</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">void</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.maxnormalize">
<code class="descclassname">loader.</code><code class="descname">maxnormalize</code><span class="sig-paren">(</span><em>X</em>, <em>axis=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#maxnormalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.maxnormalize" title="Permalink to this definition">¶</a></dt>
<dd><p>axis=1 normalizes each row of X by norm of said row. <span class="math">\(maxnormalize(X)_{ij} = \frac{X_{ij}}{max(X_{i:})}\)</span></p>
<p>axis=0 normalizes each column of X by norm of said column. <span class="math">\(maxnormalize(X)_{ij} = \frac{X_{ij}}{max(X_{
:j})}\)</span></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> &#8211; A scipy sparse csr_matrix or numpy array.</li>
<li><strong>axis</strong> &#8211; The dimension to normalize over.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A normalized matrix.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Raise:</th><td class="field-body"><p class="first last">ValueError</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.maybe_download">
<code class="descclassname">loader.</code><code class="descname">maybe_download</code><span class="sig-paren">(</span><em>filename</em>, <em>directory</em>, <em>source_url</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#maybe_download"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.maybe_download" title="Permalink to this definition">¶</a></dt>
<dd><p>Download the data from source url, unless it&#8217;s already here.
From <a class="reference external" href="https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/datasets/base.py">https://github.com/tensorflow/tensorflow/blob/master/tensorflow/contrib/learn/python/learn/datasets/base.py</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> &#8211; string, name of the file in the directory.</li>
<li><strong>directory</strong> &#8211; string, path to working directory.</li>
<li><strong>source_url</strong> &#8211; url to download from if file doesn&#8217;t exist.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Path to resulting file.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.read_data_sets">
<code class="descclassname">loader.</code><code class="descname">read_data_sets</code><span class="sig-paren">(</span><em>directory</em>, <em>folders=('train'</em>, <em>'dev'</em>, <em>'test')</em>, <em>hashlist=()</em>, <em>mix=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#read_data_sets"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.read_data_sets" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>directory</strong> &#8211; (str) Root directory containing data to load.</li>
<li><strong>folders</strong> &#8211; (dict) The subfolders of <em>directory</em> to read data from.
By default there are train, dev, and test folders.
If you want others you have to make an explicit list.</li>
<li><strong>hashlist</strong> &#8211; (dict) If you provide a hashlist these files and
only these files will be added to your <a class="reference internal" href="#loader.DataSet" title="loader.DataSet"><code class="xref any py py-class docutils literal"><span class="pre">DataSet</span></code></a> objects.
It you do not provide a hashlist then anything with
the privileged prefixes <a href="#id4"><span class="problematic" id="id5">labels_</span></a> or <a href="#id6"><span class="problematic" id="id7">features_</span></a> will be loaded.</li>
<li><strong>mix</strong> &#8211; (boolean) Whether to shuffle during mini-batching.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A <a class="reference internal" href="#loader.DataSets" title="loader.DataSets"><code class="xref any py py-class docutils literal"><span class="pre">DataSets</span></code></a> object.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">antk.core.loader</span> <span class="kn">as</span> <span class="nn">loader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/test/features_id.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/test/features_ones.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/test/labels_id.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/dev/features_id.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/dev/features_ones.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/dev/labels_id.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/train/features_id.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/train/features_ones.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data/train/labels_id.dense&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="mi">5</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<span class="go">reading train...</span>
<span class="go">reading dev...</span>
<span class="go">reading test...</span>
<span class="go">dev:</span>
<span class="go">features:</span>
<span class="go">     ones: (5, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">test:</span>
<span class="go">features:</span>
<span class="go">     ones: (5, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">train:</span>
<span class="go">features:</span>
<span class="go">     ones: (5, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">     id: (5, 5) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
</pre></div>
</div>
<div class="last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">read_data_sets</span><span class="p">(</span><span class="s1">&#39;/tmp/test_data&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">folders</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;train&#39;</span><span class="p">,</span> <span class="s1">&#39;dev&#39;</span><span class="p">],</span>
<span class="gp">... </span>                      <span class="n">hashlist</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;ones&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">show</span><span class="p">()</span> 
<span class="go">reading train...</span>
<span class="go">reading dev...</span>
<span class="go">dev:</span>
<span class="go">features:</span>
<span class="go">     ones: (5, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
<span class="go">train:</span>
<span class="go">features:</span>
<span class="go">     ones: (5, 2) &lt;type &#39;numpy.ndarray&#39;&gt;</span>
<span class="go">labels:</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.save">
<code class="descclassname">loader.</code><code class="descname">save</code><span class="sig-paren">(</span><em>filename</em>, <em>data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls :any`export_data`.
Decides how to save data by file extension.
Raises <a class="reference internal" href="#loader.UnsupportedFormatError" title="loader.UnsupportedFormatError"><code class="xref any py py-exc docutils literal"><span class="pre">UnsupportedFormatError</span></code></a> if extension is not one of the supported
extensions (mat, sparse, binary, dense, index).
Data contained in .mat files should be saved in a matrix named <em>data</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename</strong> &#8211; (str) A filename with extension of an</td>
</tr>
</tbody>
</table>
<p>accepted format for representing a matrix.
:param data: numpy array, scipy sparse matrix, or <a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a> object.</p>
</dd></dl>

<dl class="function">
<dt id="loader.tfidf">
<code class="descclassname">loader.</code><code class="descname">tfidf</code><span class="sig-paren">(</span><em>X</em>, <em>norm='l2'</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#tfidf"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.tfidf" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>X</strong> &#8211; (numpy array or scipy.sparse.csr_matrix) A document-term matrix with term counts.</li>
<li><strong>norm</strong> &#8211; Normalization strategy: <cite>l2row</cite>: normalizes the scores of rows by</li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>length of rows after basic tfidf (each document vector is a unit vector),
<cite>count</cite>: normalizes the scores of rows by the the total word count of a document.
<cite>max</cite> normalizes the scores of rows by the maximum count for a single word in a document.
:return: Returns tfidf of document-term matrix X with optional normalization.</p>
</dd></dl>

<dl class="function">
<dt id="loader.toIndex">
<code class="descclassname">loader.</code><code class="descname">toIndex</code><span class="sig-paren">(</span><em>A</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#toIndex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.toIndex" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>A</strong> &#8211; (numpy array or scipy.sparse.csr_matrix) A matrix of one hot row vectors.</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">The hot indices.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">toIndex</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">array([0, 2, 0])</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.toOnehot">
<code class="descclassname">loader.</code><code class="descname">toOnehot</code><span class="sig-paren">(</span><em>X</em>, <em>dim=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#toOnehot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.toOnehot" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> &#8211; (numpy array) Vector of indices or <a class="reference internal" href="#loader.IndexVector" title="loader.IndexVector"><code class="xref any py py-class docutils literal"><span class="pre">IndexVector</span></code></a> object</li>
<li><strong>dim</strong> &#8211; (int) Dimension of indexing</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A sparse csr_matrix of one hots.</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Examples:</th><td class="field-body"><div class="first last highlight-python"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">antk.core</span> <span class="kn">import</span> <span class="n">loader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">toOnehot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> 
<span class="go">&lt;4x4 sparse matrix of type &#39;&lt;type &#39;numpy.float64&#39;&gt;&#39;...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">toOnehot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="go">array([[ 1.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  1.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">loader</span><span class="o">.</span><span class="n">IndexVector</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dimension</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loader</span><span class="o">.</span><span class="n">toOnehot</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">toarray</span><span class="p">()</span>
<span class="go">array([[ 1.,  0.,  0.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  1.,  0.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  1.,  0.,  0.,  0.,  0.,  0.],</span>
<span class="go">       [ 0.,  0.,  0.,  1.,  0.,  0.,  0.,  0.]])</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.unit_variance">
<code class="descclassname">loader.</code><code class="descname">unit_variance</code><span class="sig-paren">(</span><em>X</em>, <em>axis=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#unit_variance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.unit_variance" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>X</strong> &#8211; (numpy array or scipy.sparse.csr_matrix) A matrix to transform to have
unit variance (over columns axis=0, over rows axis=1, over all entries axis=None)</li>
<li><strong>axis</strong> &#8211; The axis to perform the transform.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">A matrix with unit variance along the specified axis.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="loader.untar">
<code class="descclassname">loader.</code><code class="descname">untar</code><span class="sig-paren">(</span><em>fname</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/loader.html#untar"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#loader.untar" title="Permalink to this definition">¶</a></dt>
<dd><p>Untar and ungzip a file in the current directory.
:param fname: (str) Name of the .tar.gz file</p>
</dd></dl>

</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="loader_tutorial.html" class="btn btn-neutral float-right" title="Loader Tutorial" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api.html" class="btn btn-neutral" title="API: ANT modules" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2016, Aaron Tuor.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>